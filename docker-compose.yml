version: '3'

services:
    mongo:
      image: mongo:latest
      ports:
      - "27020:27017"
      volumes:
      - db:/data/MnsRepository

    mns:
      build:
        context: .
        dockerfile: Dockerfile
      volumes: 
        - ./:/app
      depends_on:
        - mongo
      entrypoint: ["python3","main.py"]

    api:
      build:
        context: .
        dockerfile: Dockerfile
      volumes: 
        - ./:/app
      depends_on:
        - mongo
        - mns
      ports:
        - "8000:8000"
      entrypoint: ["bash", "/app/start-api.sh"]

volumes:
  db: